#
#       srecord - manipulate eprom load files
#       Copyright (C) 1998, 2002, 2006, 2007 Peter Miller
#
#       This program is free software; you can redistribute it and/or modify
#       it under the terms of the GNU General Public License as published by
#       the Free Software Foundation; either version 2 of the License, or
#       (at your option) any later version.
#
#       This program is distributed in the hope that it will be useful,
#       but WITHOUT ANY WARRANTY; without even the implied warranty of
#       MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
#       GNU General Public License for more details.
#
#       You should have received a copy of the GNU General Public License
#       along with this program; if not, write to the Free Software
#       Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA 02111, USA.
#
# MANIFEST: instructions to make, how to build the srecord package
#
#       !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
#
#       W   W    A    RRRR   N   N   III  N   N  III  N   N   GGG
#       W   W   A A   R   R  NN  N    I   NN  N   I   NN  N  G   G
#       W   W  A   A  RRRR   N N N    I   N N N   I   N N N  G
#       W W W  AAAAA  R R    N  NN    I   N  NN   I   N  NN  G  GG
#       W W W  A   A  R  R   N   N    I   N   N   I   N   N  G   G
#        W W   A   A  R   R  N   N   III  N   N  III  N   N   GGG
#
#       DO NOT send patches which fix this file.  IT IS NOT the original
#       source file.  This file is GENERATED.  If you find a bug in this
#       file, please send me a patch for the the problem in the source
#       file, usually etc/Makefile.sh or etc/Makefi.file.sh or both.
#
#       !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
#
# @configure_input@
#
# The configure script generates 2 files:
#       1. This Makefile
#       2. lib/config.h
# If you change this Makefile, you may also need to change these files.
# To see what is configured by the configure script, search for @ in the
# Makefile.in file.
#
# If you wish to reconfigure the installation directories it is
# RECOMMENDED that you re-run the configure script.
#       Use ``./configure --help'' for a list options.
#

#
# directory containing the source
#
srcdir = @srcdir@
VPATH = @srcdir@

#
# the name of the install program to use
#
INSTALL = @INSTALL@
INSTALL_PROGRAM = @INSTALL_PROGRAM@
INSTALL_DATA = @INSTALL_DATA@

#
# the name of the compiler to use
#
CXX = @CXX@

#
# The compiler flags to use
#
CXXFLAGS = @CXXFLAGS@ -Wall

#
# The preprocessor flags to use
#
CPPFLAGS = @CPPFLAGS@

#
# The linker flags to use
#
LDFLAGS = @LDFLAGS@

#
# prefix for installation path
#
prefix = @prefix@
exec_prefix = @exec_prefix@

#
# where to put the executables
#       On a network, this would only be shared between machines
#       of identical cpu-hw-os flavour.  It can be read-only.
#
bindir = $(RPM_BUILD_ROOT)@bindir@

#
# where to put the manuals
#       On a network, this would be shared between all machines
#       on the network.  It can be read-only.
#
mandir = $(RPM_BUILD_ROOT)@mandir@

#
# Which yacc to use
#
YACC = @YACC@

#
# extra libraries required for your system
#
LIBS = @LIBS@

#
# commands used to format the documents
#
SOELIM = @SOELIM@
GROFF = @GROFF@
HAVE_GROFF = @HAVE_GROFF@

#
# shell to use to run tests and commands
#
SH = @SH@

#
# program used to place index within libraries
#
RANLIB = @RANLIB@
AR = ar

# --------------------------------------------------------------------------
# You should not need to change anything below this line.

#
# The default target
#
default_target: all

man/man1/.mandir: man/.mandir
	-$(INSTALL) -m 0755 -d $(mandir)/man1
	@-test -d $(mandir)/man1 && touch $@
	@sleep 1

man/.mandir:
	-$(INSTALL) -m 0755 -d $(mandir)
	@-test -d $(mandir) && touch $@
	@sleep 1

man/man5/.mandir: man/.mandir
	-$(INSTALL) -m 0755 -d $(mandir)/man5
	@-test -d $(mandir)/man5 && touch $@
	@sleep 1

srec_cat_obj = prog/srec_cat/arglex3.o prog/srec_cat/main.o

bin/srec_cat: $(srec_cat_obj) lib/libsrecord.a .bin
	$(CXX) $(LDFLAGS) -o $@ $(srec_cat_obj) lib/libsrecord.a $(LIBS)

$(bindir)/srec_cat: bin/srec_cat .bindir
	$(INSTALL_PROGRAM) bin/srec_cat $@

srec_cmp_obj = prog/srec_cmp/main.o

bin/srec_cmp: $(srec_cmp_obj) lib/libsrecord.a .bin
	$(CXX) $(LDFLAGS) -o $@ $(srec_cmp_obj) lib/libsrecord.a $(LIBS)

$(bindir)/srec_cmp: bin/srec_cmp .bindir
	$(INSTALL_PROGRAM) bin/srec_cmp $@

srec_info_obj = prog/srec_info/main.o

bin/srec_info: $(srec_info_obj) lib/libsrecord.a .bin
	$(CXX) $(LDFLAGS) -o $@ $(srec_info_obj) lib/libsrecord.a $(LIBS)

$(bindir)/srec_info: bin/srec_info .bindir
	$(INSTALL_PROGRAM) bin/srec_info $@

#
# The real default target
#
all: bin-all doc-all

bin-all: bin/srec_cat bin/srec_cmp bin/srec_info

doc-all: doc-${HAVE_GROFF}

doc-yes: etc/reference.ps

doc-no:

%.pdf: %.ps
	ps2pdf $*.ps $*.pdf

lib_obj = lib/arglex.o lib/crc16.o lib/crc32.o lib/interval.o \
		lib/progname.o lib/quit.o lib/quit/exception.o \
		lib/quit/normal.o lib/quit/prefix.o lib/r250.o \
		lib/srec/arglex.o lib/srec/arglex/get_interval.o \
		lib/srec/arglex/get_number.o \
		lib/srec/arglex/get_string.o lib/srec/arglex/input.o \
		lib/srec/arglex/output.o lib/srec/input.o \
		lib/srec/input/file.o lib/srec/input/file/aomf.o \
		lib/srec/input/file/ascii_hex.o \
		lib/srec/input/file/atmel_generic.o \
		lib/srec/input/file/binary.o \
		lib/srec/input/file/brecord.o \
		lib/srec/input/file/cosmac.o \
		lib/srec/input/file/dec_binary.o \
		lib/srec/input/file/emon52.o \
		lib/srec/input/file/fairchild.o \
		lib/srec/input/file/fastload.o \
		lib/srec/input/file/formatted_binary.o \
		lib/srec/input/file/four_packed_code.o \
		lib/srec/input/file/guess.o lib/srec/input/file/intel.o \
		lib/srec/input/file/intel16.o \
		lib/srec/input/file/mos_tech.o \
		lib/srec/input/file/needham.o \
		lib/srec/input/file/os65v.o \
		lib/srec/input/file/signetics.o \
		lib/srec/input/file/spasm.o \
		lib/srec/input/file/spectrum.o \
		lib/srec/input/file/srecord.o \
		lib/srec/input/file/stewie.o \
		lib/srec/input/file/tektronix.o \
		lib/srec/input/file/tektronix_extended.o \
		lib/srec/input/file/ti_tagged.o \
		lib/srec/input/file/ti_tagged_16.o \
		lib/srec/input/file/ti_txt.o lib/srec/input/file/vmem.o \
		lib/srec/input/file/wilson.o lib/srec/input/filter.o \
		lib/srec/input/filter/and.o \
		lib/srec/input/filter/byte_swap.o \
		lib/srec/input/filter/checksum.o \
		lib/srec/input/filter/checksum/bitnot.o \
		lib/srec/input/filter/checksum/negative.o \
		lib/srec/input/filter/checksum/positive.o \
		lib/srec/input/filter/crc16.o \
		lib/srec/input/filter/crc32.o \
		lib/srec/input/filter/crop.o \
		lib/srec/input/filter/fill.o \
		lib/srec/input/filter/length.o \
		lib/srec/input/filter/maximum.o \
		lib/srec/input/filter/minimum.o \
		lib/srec/input/filter/not.o \
		lib/srec/input/filter/offset.o \
		lib/srec/input/filter/or.o \
		lib/srec/input/filter/random_fill.o \
		lib/srec/input/filter/sequence.o \
		lib/srec/input/filter/split.o \
		lib/srec/input/filter/unfill.o \
		lib/srec/input/filter/unsplit.o \
		lib/srec/input/filter/xor.o lib/srec/input/generator.o \
		lib/srec/input/generator/constant.o \
		lib/srec/input/generator/random.o \
		lib/srec/input/generator/repeat.o \
		lib/srec/input/interval.o lib/srec/memory.o \
		lib/srec/memory/chunk.o lib/srec/memory/walker.o \
		lib/srec/memory/walker/compare.o \
		lib/srec/memory/walker/continuity.o \
		lib/srec/memory/walker/crc16.o \
		lib/srec/memory/walker/crc32.o \
		lib/srec/memory/walker/writer.o lib/srec/output.o \
		lib/srec/output/file.o lib/srec/output/file/aomf.o \
		lib/srec/output/file/ascii_hex.o \
		lib/srec/output/file/asm.o \
		lib/srec/output/file/atmel_generic.o \
		lib/srec/output/file/basic.o \
		lib/srec/output/file/binary.o \
		lib/srec/output/file/brecord.o lib/srec/output/file/c.o \
		lib/srec/output/file/cosmac.o \
		lib/srec/output/file/dec_binary.o \
		lib/srec/output/file/emon52.o \
		lib/srec/output/file/fairchild.o \
		lib/srec/output/file/fastload.o \
		lib/srec/output/file/formatted_binary.o \
		lib/srec/output/file/four_packed_code.o \
		lib/srec/output/file/intel.o \
		lib/srec/output/file/intel16.o \
		lib/srec/output/file/mos_tech.o \
		lib/srec/output/file/needham.o \
		lib/srec/output/file/os65v.o \
		lib/srec/output/file/signetics.o \
		lib/srec/output/file/spasm.o \
		lib/srec/output/file/spectrum.o \
		lib/srec/output/file/srecord.o \
		lib/srec/output/file/stewie.o \
		lib/srec/output/file/tektronix.o \
		lib/srec/output/file/tektronix_extended.o \
		lib/srec/output/file/ti_tagged.o \
		lib/srec/output/file/ti_tagged_16.o \
		lib/srec/output/file/ti_txt.o \
		lib/srec/output/file/vhdl.o lib/srec/output/file/vmem.o \
		lib/srec/output/file/wilson.o lib/srec/record.o \
		lib/versn_stamp.o lib/vsnprintf.o 

lib/libsrecord.a: $(lib_obj)
	rm -f $@
	$(AR) qc $@ $(lib_obj)
	$(RANLIB) $@

.bin:
	-mkdir bin
	-chmod 0755 bin
	@-test -d bin && touch $@
	@sleep 1

.bindir:
	-$(INSTALL) -m 0755 -d $(bindir)
	@-test -d $(bindir) && touch $@
	@sleep 1

sure: t0001a t0002a t0003a t0004a t0005a t0006a t0007a t0008a t0009a \
		t0010a t0011a t0012a t0013a t0014a t0015a t0016a t0017a \
		t0018a t0019a t0020a t0021a t0022a t0023a t0024a t0025a \
		t0026a t0027a t0028a t0029a t0030a t0031a t0032a t0033a \
		t0034a t0035a t0036a t0037a t0038a t0039a t0040a t0050a \
		t0051a t0052a t0053a t0055a t0056a t0057a t0058a t0059a \
		t0060a t0061a t0062a t0063a t0065a t0066a t0067a t0068a \
		t0069a t0070a t0071a t0072a t0073a t0075a t0076a t0077a \
		t0078a t0079a t0080a t0081a t0082a t0083a t0085a t0086a \
		t0087a t0088a t0089a t0090a t0091a t0092a t0093a t0095a \
		t0096a t0097a t0098a t0099a t0100a t0101a t0102a t0103a \
		t0105a t0106a t0107a t0108a t0109a t0110a t0111a t0112a \
		t0113a t0115a t0116a t0117a t0118a t0119a t0120a t0121a \
		t0122a t0123a t0125a t0126a t0127a t0128a t0129a t0130a \
		t0131a t0132a t0133a t0135a t0136a t0137a t0138a t0139a 
	@echo Passed All Tests

clean-obj:
	rm -f core y.tab.c y.tab.h y.output .bin .bindir
	rm -f lib/libsrecord.a lib/arglex.o lib/crc16.o lib/crc32.o
	rm -f lib/interval.o lib/progname.o lib/quit.o
	rm -f lib/quit/exception.o lib/quit/normal.o lib/quit/prefix.o
	rm -f lib/r250.o lib/srec/arglex.o
	rm -f lib/srec/arglex/get_interval.o
	rm -f lib/srec/arglex/get_number.o lib/srec/arglex/get_string.o
	rm -f lib/srec/arglex/input.o lib/srec/arglex/output.o
	rm -f lib/srec/input.o lib/srec/input/file.o
	rm -f lib/srec/input/file/aomf.o lib/srec/input/file/ascii_hex.o
	rm -f lib/srec/input/file/atmel_generic.o
	rm -f lib/srec/input/file/binary.o lib/srec/input/file/brecord.o
	rm -f lib/srec/input/file/cosmac.o
	rm -f lib/srec/input/file/dec_binary.o
	rm -f lib/srec/input/file/emon52.o
	rm -f lib/srec/input/file/fairchild.o
	rm -f lib/srec/input/file/fastload.o
	rm -f lib/srec/input/file/formatted_binary.o
	rm -f lib/srec/input/file/four_packed_code.o
	rm -f lib/srec/input/file/guess.o lib/srec/input/file/intel.o
	rm -f lib/srec/input/file/intel16.o
	rm -f lib/srec/input/file/mos_tech.o
	rm -f lib/srec/input/file/needham.o lib/srec/input/file/os65v.o
	rm -f lib/srec/input/file/signetics.o
	rm -f lib/srec/input/file/spasm.o lib/srec/input/file/spectrum.o
	rm -f lib/srec/input/file/srecord.o lib/srec/input/file/stewie.o
	rm -f lib/srec/input/file/tektronix.o
	rm -f lib/srec/input/file/tektronix_extended.o
	rm -f lib/srec/input/file/ti_tagged.o
	rm -f lib/srec/input/file/ti_tagged_16.o
	rm -f lib/srec/input/file/ti_txt.o lib/srec/input/file/vmem.o
	rm -f lib/srec/input/file/wilson.o lib/srec/input/filter.o
	rm -f lib/srec/input/filter/and.o
	rm -f lib/srec/input/filter/byte_swap.o
	rm -f lib/srec/input/filter/checksum.o
	rm -f lib/srec/input/filter/checksum/bitnot.o
	rm -f lib/srec/input/filter/checksum/negative.o
	rm -f lib/srec/input/filter/checksum/positive.o
	rm -f lib/srec/input/filter/crc16.o
	rm -f lib/srec/input/filter/crc32.o lib/srec/input/filter/crop.o
	rm -f lib/srec/input/filter/fill.o
	rm -f lib/srec/input/filter/length.o
	rm -f lib/srec/input/filter/maximum.o
	rm -f lib/srec/input/filter/minimum.o
	rm -f lib/srec/input/filter/not.o lib/srec/input/filter/offset.o
	rm -f lib/srec/input/filter/or.o
	rm -f lib/srec/input/filter/random_fill.o
	rm -f lib/srec/input/filter/sequence.o
	rm -f lib/srec/input/filter/split.o
	rm -f lib/srec/input/filter/unfill.o
	rm -f lib/srec/input/filter/unsplit.o
	rm -f lib/srec/input/filter/xor.o lib/srec/input/generator.o
	rm -f lib/srec/input/generator/constant.o
	rm -f lib/srec/input/generator/random.o
	rm -f lib/srec/input/generator/repeat.o
	rm -f lib/srec/input/interval.o lib/srec/memory.o
	rm -f lib/srec/memory/chunk.o lib/srec/memory/walker.o
	rm -f lib/srec/memory/walker/compare.o
	rm -f lib/srec/memory/walker/continuity.o
	rm -f lib/srec/memory/walker/crc16.o
	rm -f lib/srec/memory/walker/crc32.o
	rm -f lib/srec/memory/walker/writer.o lib/srec/output.o
	rm -f lib/srec/output/file.o lib/srec/output/file/aomf.o
	rm -f lib/srec/output/file/ascii_hex.o
	rm -f lib/srec/output/file/asm.o
	rm -f lib/srec/output/file/atmel_generic.o
	rm -f lib/srec/output/file/basic.o lib/srec/output/file/binary.o
	rm -f lib/srec/output/file/brecord.o lib/srec/output/file/c.o
	rm -f lib/srec/output/file/cosmac.o
	rm -f lib/srec/output/file/dec_binary.o
	rm -f lib/srec/output/file/emon52.o
	rm -f lib/srec/output/file/fairchild.o
	rm -f lib/srec/output/file/fastload.o
	rm -f lib/srec/output/file/formatted_binary.o
	rm -f lib/srec/output/file/four_packed_code.o
	rm -f lib/srec/output/file/intel.o
	rm -f lib/srec/output/file/intel16.o
	rm -f lib/srec/output/file/mos_tech.o
	rm -f lib/srec/output/file/needham.o
	rm -f lib/srec/output/file/os65v.o
	rm -f lib/srec/output/file/signetics.o
	rm -f lib/srec/output/file/spasm.o
	rm -f lib/srec/output/file/spectrum.o
	rm -f lib/srec/output/file/srecord.o
	rm -f lib/srec/output/file/stewie.o
	rm -f lib/srec/output/file/tektronix.o
	rm -f lib/srec/output/file/tektronix_extended.o
	rm -f lib/srec/output/file/ti_tagged.o
	rm -f lib/srec/output/file/ti_tagged_16.o
	rm -f lib/srec/output/file/ti_txt.o lib/srec/output/file/vhdl.o
	rm -f lib/srec/output/file/vmem.o lib/srec/output/file/wilson.o
	rm -f lib/srec/record.o lib/versn_stamp.o lib/vsnprintf.o
	rm -f man/man1/.mandir man/.mandir man/man5/.mandir
	rm -f prog/srec_cat/arglex3.o prog/srec_cat/main.o
	rm -f prog/srec_cmp/main.o prog/srec_info/main.o

clean: clean-obj
	rm -f bin/srec_cat bin/srec_cmp bin/srec_info

distclean: clean
	rm -f Makefile lib/config.h
	rm -f config.status config.cache config.log

install-bin: $(bindir)/srec_cat $(bindir)/srec_cmp $(bindir)/srec_info

install-man: install-man-${HAVE_GROFF}

install-man-yes: $(mandir)/man1/srec_cat.1 $(mandir)/man1/srec_cmp.1 \
		$(mandir)/man1/srec_examples.1 \
		$(mandir)/man1/srec_info.1 $(mandir)/man1/srec_input.1 \
		$(mandir)/man1/srec_license.1 \
		$(mandir)/man5/srec_aomf.5 \
		$(mandir)/man5/srec_ascii_hex.5 \
		$(mandir)/man5/srec_atmel_generic.5 \
		$(mandir)/man5/srec_binary.5 \
		$(mandir)/man5/srec_brecord.5 \
		$(mandir)/man5/srec_cosmac.5 \
		$(mandir)/man5/srec_dec_binary.5 \
		$(mandir)/man5/srec_emon52.5 \
		$(mandir)/man5/srec_fairchild.5 \
		$(mandir)/man5/srec_fastload.5 \
		$(mandir)/man5/srec_formatted_binary.5 \
		$(mandir)/man5/srec_fpc.5 $(mandir)/man5/srec_intel.5 \
		$(mandir)/man5/srec_intel16.5 \
		$(mandir)/man5/srec_mos_tech.5 \
		$(mandir)/man5/srec_motorola.5 \
		$(mandir)/man5/srec_needham.5 \
		$(mandir)/man5/srec_os65v.5 \
		$(mandir)/man5/srec_signetics.5 \
		$(mandir)/man5/srec_spasm.5 \
		$(mandir)/man5/srec_spectrum.5 \
		$(mandir)/man5/srec_stewie.5 \
		$(mandir)/man5/srec_tektronix.5 \
		$(mandir)/man5/srec_tektronix_extended.5 \
		$(mandir)/man5/srec_ti_tagged.5 \
		$(mandir)/man5/srec_ti_tagged_16.5 \
		$(mandir)/man5/srec_ti_txt.5 $(mandir)/man5/srec_vmem.5 \
		$(mandir)/man5/srec_wilson.5 

install-man-no:

install: install-bin install-man
